from scipy.cluster import hierarchy 
from sklearn.metrics import adjusted_rand_score
from sklearn.metrics import v_measure_score
import matplotlib.pyplot as plt

from experiments.variant_analysis.CustomAgglomClust import CustomAgglomClust
from experiments.variant_analysis.utils.Utils import Utils


def get_dict_var(dict_gd):
    dict_var = {}

    for k in dict_gd:
        dict_var[k] = []

        for i in dict_gd[k]:
            dict_var[k] += dict_gd[k][i]
    

    return dict_var

traces = ['ABCDEFBGLLBGBLGLBGLBGBLGLBGJKL', 'ABCDEFBGNLJKF', 'ABCDEFBLGLBGJKL', 'ABCDEFBNGLBNLGJKF', 'ABCDEFBNLGJKF', 'ABCDEFGBLJL', 'ABCDEFGLBJK', 'ABCDEFGLBJL', 'ABCDEFLBGJLK', 'ABCDEFLBGLBGJKL', 'ABCDEFLGBJK', 'ABCDEFLGBJL', 'ABCDEFNBGLNBGLBNLGJKF', 'ABCDEFNBLGBNGLBGNLJKF', 'ABCDEFNBLGBNGLJKF', 'ABCDEFNBLGJKF', 'ABCDEFNBLGNLBGJKF', 'ABCDEFNJK', 'ABCDEFNJKL', 'ABCDEFNJLK', 'ABCDEFNLBGJKF', 'ABCDEFNLBGNLBGBNLGJKF', 'ABCEDFBGNLJKF', 'ABCEDFBGNLNBLGBNLGNBLGNBLGBNLGJKF', 'ABCEDFBNLGBNLGNBGLBNGLNBLGNBLGJKF', 'ABCEDFNBLGJKF', 'ABCEDFNBLGNLBGBGNLBNGLJKF', 'ABCEDFNJKL', 'ABCEDFNJLK', 'ABCEDFNLBGBNLGNBGLJKF', 'ABCEDFNLBGJKF', 'ABDCEFBGNLJKF', 'ABDCEFBLGBGLBLGJKL', 'ABDCEFBLGJLK', 'ABDCEFBLGLBGJKL', 'ABDCEFBNGLJKF', 'ABDCEFBNLGBNGLNLBGNBGLBNLGNLBGNBGLJKF', 'ABDCEFBNLGBNLGJKF', 'ABDCEFBNLGJKF', 'ABDCEFBNLGNLBGJKF', 'ABDCEFGBGBLGBJL', 'ABDCEFGBLGBGBJL', 'ABDCEFGBLGBJL', 'ABDCEFGLBJL', 'ABDCEFLBGBLGJLK', 'ABDCEFLBGJKL', 'ABDCEFLGBGBGBGBGBJK', 'ABDCEFLGBJL', 'ABDCEFNJK', 'ABDCEFNJKL', 'ABDCEFNJL', 'ABDCEFNJLK', 'ABDCEFNLBGNBLGBGNLJKF', 'ABDCEFNLBGNLBGJKF', 'ABDECFGLBGBJL', 'ABDECFGLBJL', 'ABDECFLGBJK', 'ABDECFLGBJL', 'ABDECFNJK', 'ABDECFNJL', 'ACBDEFBGLLBGBGLLBGBLGJKL', 'ACBDEFBGLLBGJKL', 'ACBDEFBGNLJKF', 'ACBDEFBGNLNBGLNLBGJKF', 'ACBDEFBNGLNLBGJKF', 'ACBDEFNBGLJKF', 'ACBDEFNBLGBGNLJKF', 'ACBDEFNJKL', 'ACBDEFNJLK', 'ACBEDFBGLLBGBGLLBGLBGJLK', 'ACBEDFBGNLJKF', 'ACBEDFBLGJKL', 'ACBEDFBNGLBNLGBGNLNBGLNBLGJKF', 'ACBEDFLBGJLK', 'ACBEDFNBGLNLBGJKF', 'ACBEDFNBLGJKF', 'ACBEDFNJKL', 'ACBEDFNLBGJKF', 'ACEBDFBGLBLGLBGBLGJLK', 'ACEBDFBGLJLK', 'ACEBDFBGLLBGJKL', 'ACEBDFBGLLBGLBGBGLLBGJKL', 'ACEBDFBGLLBGLBGJKL', 'ACEBDFBGNLBGNLJKF', 'ACEBDFBGNLBNGLJKF', 'ACEBDFBGNLJKF', 'ACEBDFBGNLNBLGBGNLNLBGJKF', 'ACEBDFLBGJLK', 'ACEBDFNBGLJKF', 'ACEBDFNBLGJKF', 'ACEBDFNBLGNLBGJKF', 'ACEBDFNJKL', 'ACEBDFNJLK', 'ACEBDFNLBGBGNLJKF', 'ACEBDFNLBGNBGLJKF', 'ADBCEFGBLJK', 'ADBCEFGLBGBGBJK', 'ADBCEFLGBGBJK', 'ADBCEFLGBGBJL', 'ADBCEFLGBJL', 'ADBCEFNJK', 'ADBECFGBLGBGBGBGBJL', 'ADBECFGLBJK', 'ADBECFLGBGBJK', 'ADBECFLGBJK', 'ADBECFNJK', 'ADEBCFLGBGBGBGBGBGBJL', 'ADEBCFLGBJK', 'ADEBCFNJK', 'ADEBCFNJL', 'PQRABBCGJZKV', 'PQRABBCGZ', 'PQRABBCGZJKV', 'PQRABBCGZV', 'PQRABBGCJZKV', 'PQRABBGCZVJK', 'PQRABBGZCV', 'PQRABCBGJK', 'PQRABCBGJZVK', 'PQRABCBGZ', 'PQRABCBGZJKV', 'PQRABCBGZVJK', 'PQRABGJKBC', 'PQRABGJKBZVC', 'PQRABGJZKBVC', 'PQRABGZBC', 'PQRABGZVBJKC', 'PQRABGZVJBCK', 'PQRBABCGJK', 'PQRBABCGJZKV', 'PQRBABCGZ', 'PQRBABCGZJKV', 'PQRBABCGZV', 'PQRBABGJKCZV', 'PQRBABGJKZVC', 'PQRBAGBJKC', 'PQRBAGJBCK', 'PQRBAGZBJVKC', 'PQRBGABCJZKV', 'PQRBGABJCZKV', 'PQRBGAJKBC', 'PQRBGAJZBCVK', 'PQRBGAJZBVCK', 'PQRBGAZBJCKV', 'PQRBGJABKZVC', 'PQRBGJKABC', 'PQRBGJZKVABC', 'PQRBGJZVKABC', 'PQRBGZVABC', 'PQRPQRABBCGJKZV', 'PQRPQRABBCGZJKV', 'PQRPQRABBGZCJVK', 'PQRPQRABBGZJVCK', 'PQRPQRABCBGZJVK', 'PQRPQRABGBJZVCK', 'PQRPQRBABCGJZVK', 'PQRPQRBABCGZVJK', 'PQRPQRBABGZVJCK', 'PQRPQRBAGBZVCJK', 'PQRPQRBAGJZKBVC', 'PQRPQRBGJKZABCV', 'PQRPQRBGJKZVABC', 'PQRPQRPQRABBGZJVKC', 'PQRPQRPQRABCBGZVJK', 'PQRPQRPQRBABCGZJVK', 'PQRPQRPQRPQRABBGCZJKV', 'PQRPQRPQRPQRABGJKZVBC', 'PQRPQRPQRPQRPQRBABCGJKZV', 'PQRPQRPQRPQRPQRBAGJKZVBC', 'PQRQRABBGCZ', 'PQRQRABGBCZV', 'PQRQRBABCGJK', 'PQRQRBABCGZ', 'PQRQRBABGCJK', 'PQRQRBABGZC', 'PQRQRBABGZCV', 'PQRQRBAGJBCK', 'PQRQRBAGJBKC', 'PQRQRBAGJKBC', 'PQRQRBAGZBC', 'PQRQRBAGZBVC', 'PQRQRBGAZVBC', 'PQRQRBGJAKBC', 'PQRQRBGZABC', 'PQRQRQRABCBGJK', 'PQRQRQRABCBGZV', 'PQRQRQRABGZBC', 'PQRQRQRBABGCJK', 'PQRQRQRBABGZC', 'PQRQRQRBAGJBCK', 'PQRQRQRBGAJBCK', 'PQRQRQRBGJABCK', 'PQRQRQRBGZVABC', 'PQRQRQRQRQRABCBGZV', 'PQRQRQRQRQRBAGJBKC', 'PQRQRQRQRQRQRBAGZBC', 'PQRQRQRQRQRQRQRBGJKABC', 'PQRQRQRQRQRQRQRQRQRBAGZBC']

dend = [([43], [55], 1.0), ([43, 55], [7], 1.0), ([37], [16], 1.0), ([37, 16], [21], 1.0), ([37, 16, 21], [39], 1.0), ([37, 16, 21, 39], [53], 1.0), ([22], [4], 1.0), ([22, 4], [38], 1.0), ([22, 4, 38], [35], 1.0), ([22, 4, 38, 35], [1], 1.0), ([22, 4, 38, 35, 1], [31], 1.0), ([64], [74], 1.0), ([13], [14], 1.0), ([13, 14], [26], 1.0), ([13, 14, 26], [29], 1.0), ([70], [62], 1.0), ([3], [12], 1.0), ([194], [177], 1.0), ([189], [176], 1.0), ([187], [173], 1.0), ([188], [174], 1.0), ([179], [197], 1.0), ([179, 197], [195], 1.0), ([82], [80], 1.0), ([2], [9], 1.0), ([2, 9], [34], 1.0), ([185], [193], 1.0), ([60], [0], 0.95), ([82, 80], [81], 0.95), ([32], [60, 0], 0.9444), ([63], [64, 74], 0.9375), ([63, 64, 74], [72], 0.9375), ([24], [36], 0.9375), ([93], [94], 0.9375), ([63, 64, 74, 72], [3, 12], 0.9219), ([13, 14, 26, 29], [52], 0.9219), ([22, 4, 38, 35, 1, 31], [70, 62], 0.9091), ([73], [8], 0.9), ([73, 8], [45], 0.9), ([73, 8, 45], [43, 55, 7], 0.8944), ([49], [50], 0.8944), ([19], [17], 0.8944), ([51], [48], 0.8944), ([2, 9, 34], [44], 0.8889), ([82, 80, 81], [61], 0.8875), ([69], [82, 80, 81, 61], 0.9), ([73, 8, 45, 43, 55, 7], [2, 9, 34, 44], 0.8875), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44], [32, 60, 0], 0.8875), ([111], [113], 0.8819), ([98], [106], 0.875), ([83], [84], 0.875), ([23], [86], 0.875), ([171], [128], 0.875), ([132], [130], 0.8661), ([188, 174], [175], 0.8661), ([63, 64, 74, 72, 3, 12], [23, 86], 0.8646), ([112], [150], 0.8636), ([13, 14, 26, 29, 52], [93, 94], 0.8625), ([13, 14, 26, 29, 52, 93, 94], [66], 0.8929), ([22, 4, 38, 35, 1, 31, 70, 62], [85], 0.8586), ([110], [129], 0.8545), ([149], [167], 0.8545), ([49, 50], [51, 48], 0.8375), ([19, 17], [18], 0.8333), ([42], [54], 0.8333), ([151], [152], 0.8182), ([162], [151, 152], 0.8182), ([112, 150], [165], 0.8182), ([179, 197, 195], [180], 0.8167), ([63, 64, 74, 72, 3, 12, 23, 86], [24, 36], 0.8125), ([63, 64, 74, 72, 3, 12, 23, 86, 24, 36], [13, 14, 26, 29, 52, 93, 94, 66], 0.8125), ([63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66], [37, 16, 21, 39, 53], 0.8299), ([115], [121], 0.8091), ([153], [162, 151, 152], 0.8091), ([153, 162, 151, 152], [112, 150, 165], 0.8295), ([153, 162, 151, 152, 112, 150, 165], [163], 0.8143), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0], [69, 82, 80, 81, 61], 0.8067), ([110, 129], [114], 0.803), ([92], [28], 0.8), ([68], [67], 0.8), ([91], [27], 0.8), ([91, 27], [76], 0.9), ([92, 28], [91, 27, 76], 0.8), ([104], [103], 0.8), ([183], [192], 0.8), ([120], [131], 0.8), ([164], [156], 0.8), ([164, 156], [155], 0.8), ([133], [134], 0.8), ([49, 50, 51, 48], [68, 67], 0.7833), ([49, 50, 51, 48, 68, 67], [19, 17, 18], 0.8648), ([92, 28, 91, 27, 76], [49, 50, 51, 48, 68, 67, 19, 17, 18], 0.7864), ([108], [105], 0.7778), ([108, 105], [58], 0.7778), ([109], [59], 0.7778), ([108, 105, 58], [109, 59], 0.7778), ([138], [139], 0.7778), ([132, 130], [172], 0.7768), ([117], [118], 0.775), ([110, 129, 114], [120, 131], 0.7727), ([110, 129, 114, 120, 131], [138, 139], 0.7694), ([117, 118], [115, 121], 0.7691), ([117, 118, 115, 121], [110, 129, 114, 120, 131, 138, 139], 0.7727), ([87], [79], 0.7571), ([87, 79], [78], 0.8167), ([189, 176], [136], 0.75), ([187, 173], [171, 128], 0.75), ([116], [111, 113], 0.75), ([187, 173, 171, 128], [184], 0.75), ([185, 193], [170], 0.75), ([169], [185, 193, 170], 0.7778), ([63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53], [90], 0.7446), ([117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139], [153, 162, 151, 152, 112, 150, 165, 163], 0.7398), ([117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163], [164, 156, 155], 0.8217), ([117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155], [149, 167], 0.8182), ([135], [137], 0.7321), ([123], [124], 0.7321), ([122], [123, 124], 0.7333), ([122, 123, 124], [133, 134], 0.7341), ([122, 123, 124, 133, 134], [117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167], 0.8152), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61], [42, 54], 0.7175), ([122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167], [157], 0.7167), ([63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90], [83, 84], 0.7161), ([101], [98, 106], 0.7153), ([141], [142], 0.7143), ([108, 105, 58, 109, 59], [100], 0.7094), ([122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157], [154], 0.7054), ([169, 185, 193, 170], [132, 130, 172], 0.6996), ([169, 185, 193, 170, 132, 130, 172], [116, 111, 113], 0.7292), ([169, 185, 193, 170, 132, 130, 172, 116, 111, 113], [188, 174, 175], 0.7414), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54], [87, 79, 78], 0.6978), ([92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18], [22, 4, 38, 35, 1, 31, 70, 62, 85], 0.696), ([92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85], [108, 105, 58, 109, 59, 100], 0.7308), ([187, 173, 171, 128, 184], [122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154], 0.6806), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154], [169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175], 0.6982), ([40], [41], 0.6667), ([194, 177], [189, 176, 136], 0.6667), ([186], [125], 0.6667), ([190], [191], 0.6667), ([30], [77], 0.6666), ([92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100], [30, 77], 0.7813), ([65], [88], 0.6666), ([92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77], [65, 88], 0.8), ([15], [25], 0.6666), ([89], [75], 0.6666), ([92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88], [89, 75], 0.8035), ([183, 192], [148], 0.65), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175], [158], 0.6437), ([161], [160], 0.6333), ([194, 177, 189, 176, 136], [178], 0.6333), ([168], [166], 0.6333), ([161, 160], [168, 166], 0.7778), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158], [161, 160, 168, 166], 0.7392), ([92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75], [63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84], 0.6225), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78], [40, 41], 0.616), ([140], [145], 0.6), ([140, 145], [182], 0.6), ([140, 145, 182], [196], 0.8667), ([140, 145, 182, 196], [190, 191], 0.6333), ([194, 177, 189, 176, 136, 178], [140, 145, 182, 196, 190, 191], 0.6667), ([147], [146], 0.6), ([56], [107], 0.5833), ([104, 103], [56, 107], 0.7444), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41], [104, 103, 56, 107], 0.6583), ([15, 25], [20], 0.5833), ([183, 192, 148], [181], 0.575), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107], [101, 98, 106], 0.5635), ([135, 137], [126], 0.5625), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166], [135, 137, 126], 0.6739), ([186, 125], [179, 197, 195, 180], 0.5625), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126], [186, 125, 179, 197, 195, 180], 0.6524), ([11], [99], 0.55), ([11, 99], [47], 0.75), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106], [92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84], 0.5159), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84], [15, 25, 20], 0.5267), ([6], [10], 0.5), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180], [127], 0.498), ([11, 99, 47], [57], 0.4875), ([95], [97], 0.4667), ([143], [141, 142], 0.4643), ([187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127], [143, 141, 142], 0.661), ([194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191], [187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142], 0.4705), ([194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191, 187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142], [159], 0.4759), ([194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191, 187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142, 159], [144], 0.4499), ([183, 192, 148, 181], [147, 146], 0.38), ([194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191, 187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142, 159, 144], [183, 192, 148, 181, 147, 146], 0.3764), ([95, 97], [96], 0.3667), ([194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191, 187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142, 159, 144, 183, 192, 148, 181, 147, 146], [119], 0.3449), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20], [11, 99, 47, 57], 0.3298), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57], [95, 97, 96], 0.3225), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96], [102], 0.107), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96, 102], [6, 10], 0.0726), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96, 102, 6, 10], [33], 0.0531), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96, 102, 6, 10, 33], [46], 0.0536), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96, 102, 6, 10, 33, 46], [71], -0.0971), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96, 102, 6, 10, 33, 46, 71], [194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191, 187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142, 159, 144, 183, 192, 148, 181, 147, 146, 119], -0.3104), ([73, 8, 45, 43, 55, 7, 2, 9, 34, 44, 32, 60, 0, 69, 82, 80, 81, 61, 42, 54, 87, 79, 78, 40, 41, 104, 103, 56, 107, 101, 98, 106, 92, 28, 91, 27, 76, 49, 50, 51, 48, 68, 67, 19, 17, 18, 22, 4, 38, 35, 1, 31, 70, 62, 85, 108, 105, 58, 109, 59, 100, 30, 77, 65, 88, 89, 75, 63, 64, 74, 72, 3, 12, 23, 86, 24, 36, 13, 14, 26, 29, 52, 93, 94, 66, 37, 16, 21, 39, 53, 90, 83, 84, 15, 25, 20, 11, 99, 47, 57, 95, 97, 96, 102, 6, 10, 33, 46, 71, 194, 177, 189, 176, 136, 178, 140, 145, 182, 196, 190, 191, 187, 173, 171, 128, 184, 122, 123, 124, 133, 134, 117, 118, 115, 121, 110, 129, 114, 120, 131, 138, 139, 153, 162, 151, 152, 112, 150, 165, 163, 164, 156, 155, 149, 167, 157, 154, 169, 185, 193, 170, 132, 130, 172, 116, 111, 113, 188, 174, 175, 158, 161, 160, 168, 166, 135, 137, 126, 186, 125, 179, 197, 195, 180, 127, 143, 141, 142, 159, 144, 183, 192, 148, 181, 147, 146, 119], [5], -0.9288)]

y_true = [11, 13, 11, 13, 13, 12, 12, 12, 11, 11, 12, 12, 13, 13, 13, 13, 13, 12, 11, 11, 13, 13, 13, 13, 13, 13, 13, 11, 11, 13, 13, 13, 11, 11, 11, 13, 13, 13, 13, 13, 12, 12, 12, 12, 11, 11, 12, 12, 12, 11, 12, 11, 13, 13, 12, 12, 12, 12, 12, 12, 11, 11, 13, 13, 13, 13, 13, 11, 11, 11, 13, 11, 13, 11, 13, 13, 11, 13, 11, 11, 11, 11, 11, 13, 13, 13, 13, 11, 13, 13, 13, 11, 11, 13, 13, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 22, 21, 22, 21, 22, 22, 21, 21, 22, 21, 22, 22, 21, 22, 22, 21, 22, 22, 21, 22, 21, 22, 21, 22, 22, 21, 21, 22, 22, 22, 21, 22, 22, 22, 22, 21, 22, 22, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]

y_pred = [1, 1, 1, 1, 1, 8, 3, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7]
best_perc = 0.4

utils = Utils()
agglomClust = CustomAgglomClust()
Z = agglomClust.gen_Z(dend)



hierarchy.dendrogram(Z,color_threshold=max(Z[:,2])*best_perc)
# plt.show(block=True)
plt.gcf().set_size_inches(12, 6)
plt.tight_layout()
plt.savefig('temp/dendro_crossf.png', dpi=400)
plt.close()




# config 2, considering only the two major clusters
y_true2 = [0 if x < 20 else 1 for x in y_true]

# get best number of clusters
t = max(Z[:,2])

min_perc = 0.4
max_perc = 0.9
step_perc = 0.025
perc = min_perc

best_ARI = -1
best_Vm = -1
best_perc = -1
best_y_pred = []


while perc <= max_perc:
    labels = hierarchy.fcluster(Z=Z, t=perc*t, criterion='distance')

    # get performance by adjusted rand-score metric
    
    # y_pred = utils.get_agglom_labels_by_trace(traces, dict_var, labels)
    y_pred = labels

    ARI = adjusted_rand_score(y_true2, y_pred)
    Vm = v_measure_score(y_true2, y_pred)

    if ARI > best_ARI:
        best_ARI = ARI
        best_Vm = Vm
        best_perc = perc
        best_y_pred = y_pred.copy()

    perc += step_perc


best_ARI = round(best_ARI, 4)
best_Vm = round(best_Vm, 4)
best_perc = round(best_perc, 4)

print('best ARI: ' + str(best_ARI))
print('best Vm: ' + str(best_Vm))
print('best perc: ' + str(best_perc))

agglomClust = CustomAgglomClust()
Z = agglomClust.gen_Z(dend)

hierarchy.dendrogram(Z,color_threshold=max(Z[:,2])*best_perc)
plt.show(block=True)
plt.close()
