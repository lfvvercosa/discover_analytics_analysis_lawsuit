
########## INDEL RIGHT GIVEN LEFT ##########

AZC  III
AZB  IIII
AZBF II
AZCF I

(
 AZC: 4, 
 AZB: 6, 
 ZBF: 2, 
 ZCF: 1,
 -AZ: 10,
 ZC-: 3,
 ZB-: 4,
 BF-: 2,
 CF-: 1,
)


countRightGivenLeft(Z/A) = 10
countRightGivenLeft(C/Z) = 4
countRightGivenLeft(B/Z) = 6
countRightGivenLeft(F/B) = 2
countRightGivenLeft(F/C) = 1


norm(Z) = 10
norm(B) = 6
norm(C) = 4
norm(F) = 3

total_occur = 3*3 + 3*4 + 4*2 + 4*1 = 33

P(Z) = 10/33
P(A) = 10/33
P(B) = 6/33
P(C) = 4/33
P(F) = 3/33

normCountRightGivenLeft(Z/A) = 1
normCountRightGivenLeft(C/Z) = 1
normCountRightGivenLeft(B/Z) = 1
normCountRightGivenLeft(F/B) = 2/3
normCountRightGivenLeft(F/C) = 1/3

insRightGivenLeft(Z/A) = log2(1/((10/33)*(10/33))) = 3.444
insRightGivenLeft(C/Z) = log2(1/((4/33)*(10/33))) = 4.767
insRightGivenLeft(B/Z) = log2(1/((6/33)*(10/33))) = 4.182
insRightGivenLeft(F/B) = log2((2/3)/((3/33)*(6/33))) = 5.334
insRightGivenLeft(F/C) = log2((1/3)/((3/33)*(4/33))) = 4.918


########## SUBSTITUTION ##########

AZC  III
AZB  IIII
AZBF II
AZCF I

(
 AZC: 4, 
 AZB: 6, 
 ZBF: 2, 
 ZCF: 1,
 -AZ: 10,
 ZC-: 3,
 ZB-: 4,
 BF-: 2,
 CF-: 1,
)

C_{AC}(Z,Z) = (4*3)/2 = 6
C_{AB}(Z,Z) = (6*5)/2 = 15
C(Z,Z) = 21

C_{Z-}(C,B) = 4*3 = 12
C_{ZF}(C,B) = 2*1 = 2
C(C,B) = 14

C_{-Z}(A,A) = (10*9)/2 = 45
C(A,A) = 45

C_{B-}(F,F) = (2*1)/2 = 1
C_{C-}(F,F) = (1*0)/2 = 0
C(F,F) = 1

C_{Z-}(C,C) = (3*2)/2 = 3
C_{ZF}(C,C) = 0
C(C,C) = 3

C_{Z-}(B,B) = (4*3)/2 = 6
C_{ZF}(B,B) = (2*1)/2 = 1
C(B,B) = 7


N = C(Z,Z) + C(C,B) + C(B,C) + C(A,A) + C(F,F) + C(C,C) + C(B,B)
N = 21 + 14 + 14 + 45 + 1 + 3 + 7
N = 35 + 45 + 11 + 14 = 105


M(Z,Z) = 21/105
M(C,B) = 14/105
M(B,C) = 14/105
M(A,A) = 45/105
M(F,F) =  1/105
M(C,C) =  3/105
M(B,B) =  7/105

p(A) = M(A,A) = 45/105
p(B) = M(B,B) + M(B,C) =  7/105 + 14/105 = 21/105
p(C) = M(C,C) + M(C,B) =  3/105 + 14/105 = 17/105
p(Z) = M(Z,Z) = 21/105
p(F) = M(F,F) =  1/105


S(A,A) = log2(M(A,A)/p(A)²)

S(C,B) = log2(M(C,B)/(2*p(C)*p(B)))

S(F,F) = lo2(M(F,F)/p(F)²)


AZC  III
AZB  IIII
AZBF II
AZCF I

(
 AZC: 4, 
 AZB: 6, 
 ZBF: 2, 
 ZCF: 1
)


countRightGivenLeft(Z/A) = 10
countRightGivenLeft(C/Z) = 1
countRightGivenLeft(B/Z) = 2

norm(Z) = 10
norm(B) = 2
norm(C) = 1

total_occur = 3*3 + 3*4 + 4*2 + 4*1 = 33

P(Z) = 10/33
P(A) = 10/33
P(B) = 6/33
P(C) = 4/33
P(F) = 3/33

countRightGivenLeft(Z/A) = 1
countRightGivenLeft(C/Z) = 1
countRightGivenLeft(B/Z) = 1

insRightGivenLeft(Z/A) = log2(1/((10/33)*(10/33))) = 3.444
insRightGivenLeft(C/Z) = log2(1/((4/33)*(10/33))) = 4.767
insRightGivenLeft(B/Z) = log2(1/((6/33)*(10/33))) = 4.182

############################################################

AZC  III
AZB  IIII
AZBF II
AZCF I

(
 AZC: 4, 
 AZB: 6, 
 ZBF: 2, 
 ZCF: 1
)

countLeftGivenRight(Z/C) = 4
countLeftGivenRight(Z/B) = 6
countLeftGivenRight(B/F) = 2
countLeftGivenRight(C/F) = 1

norm(Z) = 10
norm(B) = 2
norm(C) = 1

total_occur = 3*3 + 3*4 + 4*2 + 4*1 = 33

P(Z) = 10/33
P(A) = 10/33
P(B) = 6/33
P(C) = 4/33
P(F) = 3/33

normCountLeftGivenRight(Z/C) = 4/10
normCountLeftGivenRight(Z/B) = 6/10
normCountLeftGivenRight(B/F) = 2/2
normCountLeftGivenRight(C/F) = 1/1

insLeftGivenRight(Z/C) = log2((4/10)/((10/33)*(4/33))) = 3.445
insLeftGivenRight(Z/B) = log2((6/10)/((10/33)*(6/33))) = 3.445
insLeftGivenRight(B/F) = log2(1/((6/33)*(3/33))) = 5.919
insLeftGivenRight(C/F) = log2(1/((4/33)*(3/33))) = 6.504


########## INDEL LEFT GIVEN RIGHT ##########

AZC  III
AZB  IIII
AZBF II
AZCF I

(
 AZC: 4, 
 AZB: 6, 
 ZBF: 2, 
 ZCF: 1,
 -AZ: 10,
)


countLeftGivenRight(Z/C) = 4 
countLeftGivenRight(Z/B) = 6
countLeftGivenRight(B/F) = 2
countLeftGivenRight(C/F) = 1
countLeftGivenRight(A/Z) = 10


norm(Z) = 10
norm(B) = 2
norm(C) = 1
norm(A) = 10

total_occur = 3*3 + 3*4 + 4*2 + 4*1 = 33

P(Z) = 10/33
P(A) = 10/33
P(B) = 6/33
P(C) = 4/33
P(F) = 3/33

normCountLeftGivenRight(Z/C) = 4/10
normCountLeftGivenRight(Z/B) = 6/10
normCountLeftGivenRight(B/F) = 2/2 = 1
normCountLeftGivenRight(C/F) = 1/1 = 1
normCountLeftGivenRight(A/Z) = 10/10 = 1

insLeftGivenRight(Z/C) = log2((4/10)/((10/33)*(4/33))) = 3.444
insLeftGivenRight(Z/B) = log2((6/10)/((6/33)*(10/33))) = 3.444
insLeftGivenRight(B/F) = log2(1/((6/33)*(3/33))) = 5.91
insLeftGivenRight(C/F) = log2(1/((4/33)*(3/33))) = 6.50
insLeftGivenRight(A/Z) = log2(1/((10/33)*(10/33))) = 3.44


##################################################

[('-', 0), ('I', 'A', 3.4449), ('I', 'Z', 0.13), ('D', 'A', 3.4449), ('D', 'Z', 3.4449), ('I', 'C', 4.7669), ('D', 'B', 4.1819), ('I', 'F', 5.3339), ('D', 'F', 5.3339)]


############

- AZBF & AZCF

    * No cache: ([('-', '-', 0), ('I', 'A', 3.4449), ('I', 'Z', 0.13), ('D', 'A', 3.4449), ('D', 'Z', 3.4449), ('I', 'C', 4.7669), ('D', 'B', 4.1819), ('I', 'F', 5.3339), ('D', 'F', 5.3339)], 30.0813, 0.2659)
    
    * Cache: (30.0813, 0.2659)

- AZBF & AZC

    * No cache: ([('-', '-', 0), ('I', 'A', 3.4449), ('I', 'Z', 0.13), ('D', 'A', 3.4449), ('D', 'Z', 3.4449), ('I', 'C', 4.7669), ('D', 'B', 4.1819), ('D', 'F', 5.3339)], 24.7474, 0.2829)

    * cache: (24.7474, 0.2829)

- AZBF & AZB

    * No cache: ([('-', '-', 0), ('I', 'A', 3.4449), ('I', 'Z', 0.13), ('D', 'A', 3.4449), ('D', 'Z', 3.4449), ('I', 'B', 4.1819), ('D', 'B', 4.1819), ('D', 'F', 5.3339)], 24.1624, 0.2897)

    * cache: (24.1624, 0.2897)

- AZB & AZC

    * No cache: ([('-', '-', 0), ('I', 'A', 3.4449), ('I', 'Z', 0.13), ('D', 'A', 3.4449), ('D', 'Z', 3.4449), ('I', 'C', 4.7669), ('D', 'B', 4.1819)], 19.4135, 0.3091)

    * cache: (19.4135, 0.3091)



##################################################

########## Substitution Score ##########

ABDCEF III
ACBEDF IIII
ABCDEF II
ACEBDF I

(

 A:

 -B: 5
 -C: 5

 F:

 E-: 5
 D-: 5

 B:

 AD: 3
 CE: 4
 ED: 1
 AC: 2
 
 D:
 
 BC: 3
 EF: 4
 CE: 2
 BF: 1
 
 C:

 DE: 3
 AB: 4
 BD: 2
 AE: 1
 
 E:

 CF: 3
 BD: 4
 DF: 2
 CB: 1
)

C_{-B}(A,A) = 10
C_{-C}(A,A) = 10
C(A,A) = 20

C_{E-}(F,F) = 10
C_{D-}(F,F) = 10
C(F,F) = 20

C_{C,E}(B,D) = 4*2
C(B,D) = 8

C(D,B) = 8

C_{BD}(C,E) = 2*4 = 8
C(C,E) = 8

C(E,C) = 8

C_{A,D}(B,B) = 3
C_{C,E}(B,B) = 6
C_{E,D}(B,B) = 0
C_{A,C}(B,B) = 1

C(B,B) = 10

C_{D,E}(C,C) = 3
C_{A,B}(C,C) = 6
C_{B,D}(C,C) = 1
C_{A,E}(C,C) = 0

C(C,C) = 10

C(D,D) = 10

######

C(A,A) = 20
C(B,B) = 10
C(C,C) = 10
C(D,D) = 10
C(E,E) = 10
C(F,F) = 20

C(B,D) = 8
C(D,B) = 8

C(C,E) = 8
C(E,C) = 8

######


N = C(A,A) + C(B,B) + C(C,C) + C(D,D) + C(E,E) + C(F,F) + C(B,D) + C(D,B) + C(C,E) + C(E,C) 
N = 20 + 10 + 10 + 10 + 10 + 20 + 8 + 8 + 8 + 8
N = 112

M(A,A) = 20/112
M(B,B) = 10/112
M(C,C) = 10/112
M(D,D) = 10/112
M(E,E) = 10/112
M(F,F) = 20/112

M(B,D) = 8/112
M(D,B) = 8/112

M(C,E) = 8/112
M(E,C) = 8/112

p(A) = M(A,A)  
p(B) = M(B,B) + M(B,D) 
p(C) = M(C,C) + M(C,E) 
p(D) = M(D,D) + M(D,B)
p(E) = M(E,E) + M(E,C) 
p(F) = M(F,F)

p(A) = 20/112
p(B) = 10/112 + 8/112 = 18/112
p(C) = 10/112 + 8/112 = 18/112
p(D) = 10/112 + 8/112 = 18/112
p(E) = 10/112 + 8/112 = 18/112
p(F) = 20/112

